from string import Template as pyTemplate
from collections import namedtuple
import pathlib
from bs4 import BeautifulSoup
import htmlmin

class Vuefy:
    def __init__(self, path, prefix='.html'):
        the_path = pathlib.Path( path )
        with open( the_path.absolute() ) as file:
            html = file.read()
        self.path = the_path
        self.name = the_path.name.replace(prefix,'')
        self.soup = BeautifulSoup(html, 'html.parser')

    def html(self):
        try:
            first_part = str( self.soup.template.prettify() ).strip().split('\n')[1:]
            if first_part[-1:][0].strip() == '':  return "\n".join( first_part[:-2] )
            else                               :  return "\n".join( first_part[:-1] )
        except Exception as e:
            return ''

    def script(self):
        try:
            return "\n".join(self.soup.script.text.strip().split('\n')[1:]).strip()
        except Exception as e:
            return ""

    def vue(self):
        return ( f"""
const { self.name } = {{
  template: `{ (htmlmin.minify(self.html(), remove_empty_space=True).strip() ) }`,
  { self.script()[:-1] }
}};
""" )

def make_mixin(_components):
    components = ",\n".join( _components )
    return pyTemplate("""
Vue.mixin({ components: {
${components}
} });
    """).substitute(components=components)

def vue_components(root, components):
    paths = []
    names = []
    out   = []
    for cmp in components:
        if cmp.startswith('/'): cmp.replace('/', '', 1)
        file = Vuefy( f'{ root }/components/{ cmp }.html' )
        out.append( file.vue() )
        names.append( file.name )
        paths.append( file.path )
    mixin  = make_mixin( names )
    script = "\n".join( out )
    VUE = namedtuple("Vue", ['mixin', 'script', 'paths'])
    return VUE(mixin, script, paths)

def material_color():
    colors = [{'color': '#ffebee', 'name': 'red', 'extra': 'lighten-5'}, {'color': '#ffcdd2', 'name': 'red', 'extra': 'lighten-4'}, {'color': '#ef9a9a', 'name': 'red', 'extra': 'lighten-3'}, {'color': '#e57373', 'name': 'red', 'extra': 'lighten-2'}, {'color': '#ef5350', 'name': 'red', 'extra': 'lighten-1'}, {'color': '#f44336', 'name': 'red'}, {'color': '#e53935', 'name': 'red', 'extra': 'darken-1'}, {'color': '#d32f2f', 'name': 'red', 'extra': 'darken-2'}, {'color': '#c62828', 'name': 'red', 'extra': 'darken-3'}, {'color': '#b71c1c', 'name': 'red', 'extra': 'darken-4'}, {'color': '#ff8a80', 'name': 'red', 'extra': 'accent-1'}, {'color': '#ff5252', 'name': 'red', 'extra': 'accent-2'}, {'color': '#ff1744', 'name': 'red', 'extra': 'accent-3'}, {'color': '#d50000', 'name': 'red', 'extra': 'accent-4'}, {'color': '#fce4ec', 'name': 'pink', 'extra': 'lighten-5'}, {'color': '#f8bbd0', 'name': 'pink', 'extra': 'lighten-4'}, {'color': '#f48fb1', 'name': 'pink', 'extra': 'lighten-3'}, {'color': '#f06292', 'name': 'pink', 'extra': 'lighten-2'}, {'color': '#ec407a', 'name': 'pink', 'extra': 'lighten-1'}, {'color': '#e91e63', 'name': 'pink'}, {'color': '#d81b60', 'name': 'pink', 'extra': 'darken-1'}, {'color': '#c2185b', 'name': 'pink', 'extra': 'darken-2'}, {'color': '#ad1457', 'name': 'pink', 'extra': 'darken-3'}, {'color': '#880e4f', 'name': 'pink', 'extra': 'darken-4'}, {'color': '#ff80ab', 'name': 'pink', 'extra': 'accent-1'}, {'color': '#ff4081', 'name': 'pink', 'extra': 'accent-2'}, {'color': '#f50057', 'name': 'pink', 'extra': 'accent-3'}, {'color': '#c51162', 'name': 'pink', 'extra': 'accent-4'}, {'color': '#f3e5f5', 'name': 'purple', 'extra': 'lighten-5'}, {'color': '#e1bee7', 'name': 'purple', 'extra': 'lighten-4'}, {'color': '#ce93d8', 'name': 'purple', 'extra': 'lighten-3'}, {'color': '#ba68c8', 'name': 'purple', 'extra': 'lighten-2'}, {'color': '#ab47bc', 'name': 'purple', 'extra': 'lighten-1'}, {'color': '#9c27b0', 'name': 'purple'}, {'color': '#8e24aa', 'name': 'purple', 'extra': 'darken-1'}, {'color': '#7b1fa2', 'name': 'purple', 'extra': 'darken-2'}, {'color': '#6a1b9a', 'name': 'purple', 'extra': 'darken-3'}, {'color': '#4a148c', 'name': 'purple', 'extra': 'darken-4'}, {'color': '#ea80fc', 'name': 'purple', 'extra': 'accent-1'}, {'color': '#e040fb', 'name': 'purple', 'extra': 'accent-2'}, {'color': '#d500f9', 'name': 'purple', 'extra': 'accent-3'}, {'color': '#aa00ff', 'name': 'purple', 'extra': 'accent-4'}, {'color': '#ede7f6', 'name': 'deep-purple', 'extra': 'lighten-5'}, {'color': '#d1c4e9', 'name': 'deep-purple', 'extra': 'lighten-4'}, {'color': '#b39ddb', 'name': 'deep-purple', 'extra': 'lighten-3'}, {'color': '#9575cd', 'name': 'deep-purple', 'extra': 'lighten-2'}, {'color': '#7e57c2', 'name': 'deep-purple', 'extra': 'lighten-1'}, {'color': '#673ab7', 'name': 'deep-purple'}, {'color': '#5e35b1', 'name': 'deep-purple', 'extra': 'darken-1'}, {'color': '#512da8', 'name': 'deep-purple', 'extra': 'darken-2'}, {'color': '#4527a0', 'name': 'deep-purple', 'extra': 'darken-3'}, {'color': '#311b92', 'name': 'deep-purple', 'extra': 'darken-4'}, {'color': '#b388ff', 'name': 'deep-purple', 'extra': 'accent-1'}, {'color': '#7c4dff', 'name': 'deep-purple', 'extra': 'accent-2'}, {'color': '#651fff', 'name': 'deep-purple', 'extra': 'accent-3'}, {'color': '#6200ea', 'name': 'deep-purple', 'extra': 'accent-4'}, {'color': '#e8eaf6', 'name': 'indigo', 'extra': 'lighten-5'}, {'color': '#c5cae9', 'name': 'indigo', 'extra': 'lighten-4'}, {'color': '#9fa8da', 'name': 'indigo', 'extra': 'lighten-3'}, {'color': '#7986cb', 'name': 'indigo', 'extra': 'lighten-2'}, {'color': '#5c6bc0', 'name': 'indigo', 'extra': 'lighten-1'}, {'color': '#3f51b5', 'name': 'indigo'}, {'color': '#3949ab', 'name': 'indigo', 'extra': 'darken-1'}, {'color': '#303f9f', 'name': 'indigo', 'extra': 'darken-2'}, {'color': '#283593', 'name': 'indigo', 'extra': 'darken-3'}, {'color': '#1a237e', 'name': 'indigo', 'extra': 'darken-4'}, {'color': '#8c9eff', 'name': 'indigo', 'extra': 'accent-1'}, {'color': '#536dfe', 'name': 'indigo', 'extra': 'accent-2'}, {'color': '#3d5afe', 'name': 'indigo', 'extra': 'accent-3'}, {'color': '#304ffe', 'name': 'indigo', 'extra': 'accent-4'}, {'color': '#e3f2fd', 'name': 'blue', 'extra': 'lighten-5'}, {'color': '#bbdefb', 'name': 'blue', 'extra': 'lighten-4'}, {'color': '#90caf9', 'name': 'blue', 'extra': 'lighten-3'}, {'color': '#64b5f6', 'name': 'blue', 'extra': 'lighten-2'}, {'color': '#42a5f5', 'name': 'blue', 'extra': 'lighten-1'}, {'color': '#2196f3', 'name': 'blue'}, {'color': '#1e88e5', 'name': 'blue', 'extra': 'darken-1'}, {'color': '#1976d2', 'name': 'blue', 'extra': 'darken-2'}, {'color': '#1565c0', 'name': 'blue', 'extra': 'darken-3'}, {'color': '#0d47a1', 'name': 'blue', 'extra': 'darken-4'}, {'color': '#82b1ff', 'name': 'blue', 'extra': 'accent-1'}, {'color': '#448aff', 'name': 'blue', 'extra': 'accent-2'}, {'color': '#2979ff', 'name': 'blue', 'extra': 'accent-3'}, {'color': '#2962ff', 'name': 'blue', 'extra': 'accent-4'}, {'color': '#e1f5fe', 'name': 'light-blue', 'extra': 'lighten-5'}, {'color': '#b3e5fc', 'name': 'light-blue', 'extra': 'lighten-4'}, {'color': '#81d4fa', 'name': 'light-blue', 'extra': 'lighten-3'}, {'color': '#4fc3f7', 'name': 'light-blue', 'extra': 'lighten-2'}, {'color': '#29b6f6', 'name': 'light-blue', 'extra': 'lighten-1'}, {'color': '#03a9f4', 'name': 'light-blue'}, {'color': '#039be5', 'name': 'light-blue', 'extra': 'darken-1'}, {'color': '#0288d1', 'name': 'light-blue', 'extra': 'darken-2'}, {'color': '#0277bd', 'name': 'light-blue', 'extra': 'darken-3'}, {'color': '#01579b', 'name': 'light-blue', 'extra': 'darken-4'}, {'color': '#80d8ff', 'name': 'light-blue', 'extra': 'accent-1'}, {'color': '#40c4ff', 'name': 'light-blue', 'extra': 'accent-2'}, {'color': '#00b0ff', 'name': 'light-blue', 'extra': 'accent-3'}, {'color': '#0091ea', 'name': 'light-blue', 'extra': 'accent-4'}, {'color': '#e0f7fa', 'name': 'cyan', 'extra': 'lighten-5'}, {'color': '#b2ebf2', 'name': 'cyan', 'extra': 'lighten-4'}, {'color': '#80deea', 'name': 'cyan', 'extra': 'lighten-3'}, {'color': '#4dd0e1', 'name': 'cyan', 'extra': 'lighten-2'}, {'color': '#26c6da', 'name': 'cyan', 'extra': 'lighten-1'}, {'color': '#00bcd4', 'name': 'cyan'}, {'color': '#00acc1', 'name': 'cyan', 'extra': 'darken-1'}, {'color': '#0097a7', 'name': 'cyan', 'extra': 'darken-2'}, {'color': '#00838f', 'name': 'cyan', 'extra': 'darken-3'}, {'color': '#006064', 'name': 'cyan', 'extra': 'darken-4'}, {'color': '#84ffff', 'name': 'cyan', 'extra': 'accent-1'}, {'color': '#18ffff', 'name': 'cyan', 'extra': 'accent-2'}, {'color': '#00e5ff', 'name': 'cyan', 'extra': 'accent-3'}, {'color': '#00b8d4', 'name': 'cyan', 'extra': 'accent-4'}, {'color': '#e0f2f1', 'name': 'teal', 'extra': 'lighten-5'}, {'color': '#b2dfdb', 'name': 'teal', 'extra': 'lighten-4'}, {'color': '#80cbc4', 'name': 'teal', 'extra': 'lighten-3'}, {'color': '#4db6ac', 'name': 'teal', 'extra': 'lighten-2'}, {'color': '#26a69a', 'name': 'teal', 'extra': 'lighten-1'}, {'color': '#009688', 'name': 'teal'}, {'color': '#00897b', 'name': 'teal', 'extra': 'darken-1'}, {'color': '#00796b', 'name': 'teal', 'extra': 'darken-2'}, {'color': '#00695c', 'name': 'teal', 'extra': 'darken-3'}, {'color': '#004d40', 'name': 'teal', 'extra': 'darken-4'}, {'color': '#a7ffeb', 'name': 'teal', 'extra': 'accent-1'}, {'color': '#64ffda', 'name': 'teal', 'extra': 'accent-2'}, {'color': '#1de9b6', 'name': 'teal', 'extra': 'accent-3'}, {'color': '#00bfa5', 'name': 'teal', 'extra': 'accent-4'}, {'color': '#e8f5e9', 'name': 'green', 'extra': 'lighten-5'}, {'color': '#c8e6c9', 'name': 'green', 'extra': 'lighten-4'}, {'color': '#a5d6a7', 'name': 'green', 'extra': 'lighten-3'}, {'color': '#81c784', 'name': 'green', 'extra': 'lighten-2'}, {'color': '#66bb6a', 'name': 'green', 'extra': 'lighten-1'}, {'color': '#4caf50', 'name': 'green'}, {'color': '#43a047', 'name': 'green', 'extra': 'darken-1'}, {'color': '#388e3c', 'name': 'green', 'extra': 'darken-2'}, {'color': '#2e7d32', 'name': 'green', 'extra': 'darken-3'}, {'color': '#1b5e20', 'name': 'green', 'extra': 'darken-4'}, {'color': '#b9f6ca', 'name': 'green', 'extra': 'accent-1'}, {'color': '#69f0ae', 'name': 'green', 'extra': 'accent-2'}, {'color': '#00e676', 'name': 'green', 'extra': 'accent-3'}, {'color': '#00c853', 'name': 'green', 'extra': 'accent-4'}, {'color': '#f1f8e9', 'name': 'light-green', 'extra': 'lighten-5'}, {'color': '#dcedc8', 'name': 'light-green', 'extra': 'lighten-4'}, {'color': '#c5e1a5', 'name': 'light-green', 'extra': 'lighten-3'}, {'color': '#aed581', 'name': 'light-green', 'extra': 'lighten-2'}, {'color': '#9ccc65', 'name': 'light-green', 'extra': 'lighten-1'}, {'color': '#8bc34a', 'name': 'light-green'}, {'color': '#7cb342', 'name': 'light-green', 'extra': 'darken-1'}, {'color': '#689f38', 'name': 'light-green', 'extra': 'darken-2'}, {'color': '#558b2f', 'name': 'light-green', 'extra': 'darken-3'}, {'color': '#33691e', 'name': 'light-green', 'extra': 'darken-4'}, {'color': '#ccff90', 'name': 'light-green', 'extra': 'accent-1'}, {'color': '#b2ff59', 'name': 'light-green', 'extra': 'accent-2'}, {'color': '#76ff03', 'name': 'light-green', 'extra': 'accent-3'}, {'color': '#64dd17', 'name': 'light-green', 'extra': 'accent-4'}, {'color': '#f9fbe7', 'name': 'lime', 'extra': 'lighten-5'}, {'color': '#f0f4c3', 'name': 'lime', 'extra': 'lighten-4'}, {'color': '#e6ee9c', 'name': 'lime', 'extra': 'lighten-3'}, {'color': '#dce775', 'name': 'lime', 'extra': 'lighten-2'}, {'color': '#d4e157', 'name': 'lime', 'extra': 'lighten-1'}, {'color': '#cddc39', 'name': 'lime'}, {'color': '#c0ca33', 'name': 'lime', 'extra': 'darken-1'}, {'color': '#afb42b', 'name': 'lime', 'extra': 'darken-2'}, {'color': '#9e9d24', 'name': 'lime', 'extra': 'darken-3'}, {'color': '#827717', 'name': 'lime', 'extra': 'darken-4'}, {'color': '#f4ff81', 'name': 'lime', 'extra': 'accent-1'}, {'color': '#eeff41', 'name': 'lime', 'extra': 'accent-2'}, {'color': '#c6ff00', 'name': 'lime', 'extra': 'accent-3'}, {'color': '#aeea00', 'name': 'lime', 'extra': 'accent-4'}, {'color': '#fffde7', 'name': 'yellow', 'extra': 'lighten-5'}, {'color': '#fff9c4', 'name': 'yellow', 'extra': 'lighten-4'}, {'color': '#fff59d', 'name': 'yellow', 'extra': 'lighten-3'}, {'color': '#fff176', 'name': 'yellow', 'extra': 'lighten-2'}, {'color': '#ffee58', 'name': 'yellow', 'extra': 'lighten-1'}, {'color': '#ffeb3b', 'name': 'yellow'}, {'color': '#fdd835', 'name': 'yellow', 'extra': 'darken-1'}, {'color': '#fbc02d', 'name': 'yellow', 'extra': 'darken-2'}, {'color': '#f9a825', 'name': 'yellow', 'extra': 'darken-3'}, {'color': '#f57f17', 'name': 'yellow', 'extra': 'darken-4'}, {'color': '#ffff8d', 'name': 'yellow', 'extra': 'accent-1'}, {'color': '#ffff00', 'name': 'yellow', 'extra': 'accent-2'}, {'color': '#ffea00', 'name': 'yellow', 'extra': 'accent-3'}, {'color': '#ffd600', 'name': 'yellow', 'extra': 'accent-4'}, {'color': '#fff8e1', 'name': 'amber', 'extra': 'lighten-5'}, {'color': '#ffecb3', 'name': 'amber', 'extra': 'lighten-4'}, {'color': '#ffe082', 'name': 'amber', 'extra': 'lighten-3'}, {'color': '#ffd54f', 'name': 'amber', 'extra': 'lighten-2'}, {'color': '#ffca28', 'name': 'amber', 'extra': 'lighten-1'}, {'color': '#ffc107', 'name': 'amber'}, {'color': '#ffb300', 'name': 'amber', 'extra': 'darken-1'}, {'color': '#ffa000', 'name': 'amber', 'extra': 'darken-2'}, {'color': '#ff8f00', 'name': 'amber', 'extra': 'darken-3'}, {'color': '#ff6f00', 'name': 'amber', 'extra': 'darken-4'}, {'color': '#ffe57f', 'name': 'amber', 'extra': 'accent-1'}, {'color': '#ffd740', 'name': 'amber', 'extra': 'accent-2'}, {'color': '#ffc400', 'name': 'amber', 'extra': 'accent-3'}, {'color': '#ffab00', 'name': 'amber', 'extra': 'accent-4'}, {'color': '#fff3e0', 'name': 'orange', 'extra': 'lighten-5'}, {'color': '#ffe0b2', 'name': 'orange', 'extra': 'lighten-4'}, {'color': '#ffcc80', 'name': 'orange', 'extra': 'lighten-3'}, {'color': '#ffb74d', 'name': 'orange', 'extra': 'lighten-2'}, {'color': '#ffa726', 'name': 'orange', 'extra': 'lighten-1'}, {'color': '#ff9800', 'name': 'orange'}, {'color': '#fb8c00', 'name': 'orange', 'extra': 'darken-1'}, {'color': '#f57c00', 'name': 'orange', 'extra': 'darken-2'}, {'color': '#ef6c00', 'name': 'orange', 'extra': 'darken-3'}, {'color': '#e65100', 'name': 'orange', 'extra': 'darken-4'}, {'color': '#ffd180', 'name': 'orange', 'extra': 'accent-1'}, {'color': '#ffab40', 'name': 'orange', 'extra': 'accent-2'}, {'color': '#ff9100', 'name': 'orange', 'extra': 'accent-3'}, {'color': '#ff6d00', 'name': 'orange', 'extra': 'accent-4'}, {'color': '#fbe9e7', 'name': 'deep-orange', 'extra': 'lighten-5'}, {'color': '#ffccbc', 'name': 'deep-orange', 'extra': 'lighten-4'}, {'color': '#ffab91', 'name': 'deep-orange', 'extra': 'lighten-3'}, {'color': '#ff8a65', 'name': 'deep-orange', 'extra': 'lighten-2'}, {'color': '#ff7043', 'name': 'deep-orange', 'extra': 'lighten-1'}, {'color': '#ff5722', 'name': 'deep-orange'}, {'color': '#f4511e', 'name': 'deep-orange', 'extra': 'darken-1'}, {'color': '#e64a19', 'name': 'deep-orange', 'extra': 'darken-2'}, {'color': '#d84315', 'name': 'deep-orange', 'extra': 'darken-3'}, {'color': '#bf360c', 'name': 'deep-orange', 'extra': 'darken-4'}, {'color': '#ff9e80', 'name': 'deep-orange', 'extra': 'accent-1'}, {'color': '#ff6e40', 'name': 'deep-orange', 'extra': 'accent-2'}, {'color': '#ff3d00', 'name': 'deep-orange', 'extra': 'accent-3'}, {'color': '#dd2c00', 'name': 'deep-orange', 'extra': 'accent-4'}, {'color': '#efebe9', 'name': 'brown', 'extra': 'lighten-5'}, {'color': '#d7ccc8', 'name': 'brown', 'extra': 'lighten-4'}, {'color': '#bcaaa4', 'name': 'brown', 'extra': 'lighten-3'}, {'color': '#a1887f', 'name': 'brown', 'extra': 'lighten-2'}, {'color': '#8d6e63', 'name': 'brown', 'extra': 'lighten-1'}, {'color': '#795548', 'name': 'brown'}, {'color': '#6d4c41', 'name': 'brown', 'extra': 'darken-1'}, {'color': '#5d4037', 'name': 'brown', 'extra': 'darken-2'}, {'color': '#4e342e', 'name': 'brown', 'extra': 'darken-3'}, {'color': '#3e2723', 'name': 'brown', 'extra': 'darken-4'}, {'color': '#fafafa', 'name': 'grey', 'extra': 'lighten-5'}, {'color': '#f5f5f5', 'name': 'grey', 'extra': 'lighten-4'}, {'color': '#eeeeee', 'name': 'grey', 'extra': 'lighten-3'}, {'color': '#e0e0e0', 'name': 'grey', 'extra': 'lighten-2'}, {'color': '#bdbdbd', 'name': 'grey', 'extra': 'lighten-1'}, {'color': '#9e9e9e', 'name': 'grey'}, {'color': '#757575', 'name': 'grey', 'extra': 'darken-1'}, {'color': '#616161', 'name': 'grey', 'extra': 'darken-2'}, {'color': '#424242', 'name': 'grey', 'extra': 'darken-3'}, {'color': '#212121', 'name': 'grey', 'extra': 'darken-4'}, {'color': '#eceff1', 'name': 'blue-grey', 'extra': 'lighten-5'}, {'color': '#cfd8dc', 'name': 'blue-grey', 'extra': 'lighten-4'}, {'color': '#b0bec5', 'name': 'blue-grey', 'extra': 'lighten-3'}, {'color': '#90a4ae', 'name': 'blue-grey', 'extra': 'lighten-2'}, {'color': '#78909c', 'name': 'blue-grey', 'extra': 'lighten-1'}, {'color': '#607d8b', 'name': 'blue-grey'}, {'color': '#546e7a', 'name': 'blue-grey', 'extra': 'darken-1'}, {'color': '#455a64', 'name': 'blue-grey', 'extra': 'darken-2'}, {'color': '#37474f', 'name': 'blue-grey', 'extra': 'darken-3'}, {'color': '#263238', 'name': 'blue-grey', 'extra': 'darken-4'}, {'color': '#000000', 'name': 'black'}, {'color': '#ffffff', 'name': 'white'}]

    css = ""
    for c in colors:
        css += "\n"
        if len(c) == 2: css += ( f".{ c['name'] }--text" +' {' + f" color: { c['color'] }; " + '}')
        if len(c) == 3: css += ( f".{ c['name'] }--text.{ c['extra'] }" +' {' + f" color: { c['color'] }; " + '}')
    for c in colors:
        css += "\n"
        if len(c) == 2: css += ( f".{ c['name'] }" +' {' + f" background-color: { c['color'] }; " + '}')
        if len(c) == 3: css += ( f".{ c['name'] }.{ c['extra'] }" +' {' + f" background-color: { c['color'] }; " + '}')
    for c in colors:
        css += "\n"
        if len(c) == 2: css += ( f".{ c['name'] }--border" +' {' + "border: solid 1px;" + f" border-color: { c['color'] }; " + '}')
        if len(c) == 3: css += ( f".{ c['name'] }--border.{ c['extra'] }" +' {' + "border: solid 1px;" + f" border-color: { c['color'] }; " + '}')
    print(css)

#material_color()
